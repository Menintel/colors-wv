<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="colors.Views.ColorPickerPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:colors.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{StaticResource AppBackgroundBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid Grid.Row="0" Padding="16" Background="Transparent">
            <StackPanel>
                <TextBlock Text="Screen Color Picker" FontSize="20" FontWeight="SemiBold" Foreground="{StaticResource TextFillColorPrimaryBrush}"/>
                <TextBlock Text="Pick colors from anywhere" Foreground="{StaticResource TextFillColorSecondaryBrush}" FontSize="12" Margin="0,2,0,0"/>
            </StackPanel>
        </Grid>

        <!-- Content -->
        <ScrollViewer Grid.Row="1" Padding="16">
            <StackPanel Spacing="16">
                
                <!-- Live Color Preview (Top) -->
                <StackPanel 
                    Background="{StaticResource CardBackgroundBrush}" 
                    Padding="16" 
                    CornerRadius="12"
                    Spacing="12">
                    
                    <!-- Large Color Swatch -->
                    <Border 
                        x:Name="LiveColorSwatch"
                        Height="100" 
                        CornerRadius="8"
                        Background="#808080"
                        BorderBrush="{StaticResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"/>
                        
                    <!-- Color Values -->
                    <StackPanel Spacing="4">
                        <TextBlock x:Name="HexValue" Text="HEX: #808080" FontSize="16" FontWeight="Bold" Foreground="{StaticResource TextFillColorPrimaryBrush}"/>
                        <TextBlock x:Name="RgbValue" Text="RGB: (128, 128, 128)" Foreground="{StaticResource TextFillColorSecondaryBrush}"/>
                        <TextBlock x:Name="PositionValue" Text="Position: (0, 0)" FontSize="10" Foreground="{StaticResource TextFillColorTertiaryBrush}"/>
                    </StackPanel>

                    <!-- Picker Button -->
                    <Button 
                        x:Name="StartPickerButton"
                        Click="StartPickerButton_Click"
                        HorizontalAlignment="Stretch"
                        Style="{StaticResource AccentButtonStyle}"
                        CornerRadius="8"
                        Height="40">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xEF3C;" FontSize="16"/>
                            <TextBlock Text="Start Picking"/>
                        </StackPanel>
                    </Button>
                    <TextBlock x:Name="InstructionText" Text="" FontSize="12" Foreground="{StaticResource TextFillColorSecondaryBrush}" TextWrapping="Wrap" HorizontalAlignment="Center" TextAlignment="Center"/>
                </StackPanel> 

                <!-- Quick Actions -->
                <StackPanel 
                    Background="{StaticResource CardBackgroundBrush}" 
                    Padding="16" 
                    CornerRadius="12"
                    Spacing="12">
                    
                    <TextBlock Text="Actions" FontSize="14" FontWeight="SemiBold" Foreground="{StaticResource TextFillColorPrimaryBrush}"/>
                    
                    <Grid ColumnSpacing="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <Button 
                            x:Name="CopyHexButton"
                            Click="CopyHexButton_Click"
                            Grid.Column="0"
                            HorizontalAlignment="Stretch"
                            IsEnabled="False">
                            <TextBlock Text="Copy HEX"/>
                        </Button>
                        
                        <Button 
                            x:Name="CopyRgbButton"
                            Click="CopyRgbButton_Click"
                            Grid.Column="1"
                            HorizontalAlignment="Stretch"
                            IsEnabled="False">
                            <TextBlock Text="Copy RGB"/>
                        </Button>
                    </Grid>
                    
                    <Button 
                        x:Name="SaveColorButton"
                        Click="SaveColorButton_Click"
                        HorizontalAlignment="Stretch"
                        IsEnabled="False">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE74E;"/>
                            <TextBlock Text="Save to History"/>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!-- Color History -->
                <StackPanel Spacing="8">
                    <Grid>
                        <TextBlock Text="History" FontSize="16" FontWeight="SemiBold" Foreground="{StaticResource TextFillColorPrimaryBrush}"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="8">
                            <Button Content="Clear" Click="ClearHistory_Click" FontSize="12" Padding="8,4" MinHeight="24"/>
                        </StackPanel>
                    </Grid>

                    <ListView x:Name="ColorHistoryList" SelectionMode="None">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid 
                                    Margin="0,0,0,8" 
                                    Padding="12" 
                                    Background="{StaticResource CardBackgroundBrush}" 
                                    CornerRadius="8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Swatch -->
                                    <Border 
                                        Grid.Column="0"
                                        Width="40" 
                                        Height="40" 
                                        CornerRadius="6"
                                        Margin="0,0,12,0">
                                        <Border.Background>
                                            <SolidColorBrush Color="{Binding WindowsColor}"/>
                                        </Border.Background>
                                    </Border>

                                    <!-- Info -->
                                    <StackPanel Grid.Column="1" VerticalAlignment="Center" Spacing="2">
                                        <TextBlock Text="{Binding HexColor}" FontWeight="SemiBold" FontSize="14" Foreground="{StaticResource TextFillColorPrimaryBrush}"/>
                                        <TextBlock Text="{Binding CreatedAt}" Foreground="{StaticResource TextFillColorTertiaryBrush}" FontSize="10"/>
                                    </StackPanel>

                                    <!-- Actions -->
                                    <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="4">
                                        <Button Click="CopyHistoryColor_Click" Tag="{Binding}" Padding="6" Background="Transparent" BorderThickness="0">
                                            <FontIcon Glyph="&#xE8C8;" FontSize="14"/>
                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                <Setter Property="Padding" Value="0"/>
                                <Setter Property="Margin" Value="0,0,0,4"/>
                            </Style>
                        </ListView.ItemContainerStyle>
                    </ListView>

                    <!-- Empty State -->
                    <StackPanel 
                        x:Name="EmptyHistoryState"
                        Margin="0,24,0,0"
                        HorizontalAlignment="Center">
                        <TextBlock 
                            Text="No recent colors" 
                            FontSize="14" 
                            Foreground="{StaticResource TextFillColorSecondaryBrush}"
                            TextAlignment="Center"/>
                    </StackPanel>
                </StackPanel>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
